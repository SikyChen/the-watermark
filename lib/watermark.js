!function(t,e){if("object"==typeof exports&&"object"==typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var i=e();for(var n in i)("object"==typeof exports?exports:t)[n]=i[n]}}(self,(()=>(()=>{"use strict";var t={d:(e,i)=>{for(var n in i)t.o(i,n)&&!t.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:i[n]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e),r:t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}},e={};t.r(e),t.d(e,{Watermark:()=>i});class i{config={container:null,content:"watermark",width:300,height:200,zIndex:1e3,font:"28px Microsoft Yahei",textAlign:"center",textBaseline:"middle",color:"rgba(0, 0, 0, 0.2)",rotate:-34};container=null;isFixed=!1;dataUrl=void 0;styleString="";wm=void 0;observer=void 0;constructor(t={}){this.config={...this.config,...t},this.container=this.config.container,this.setContainer(),this.generateDataUrl(),this.generateStyleString(),this.generateWatermark(),this.observerContainer()}setContainer(){this.container||(this.container=document.querySelector("body"),this.isFixed=!0),this.isFixed||["absolute","relative","fixed"].includes(this.container.style.position)||(this.container.style.position="relative")}generateDataUrl(){const{width:t,height:e,font:i,textAlign:n,textBaseline:r,color:o,rotate:s,content:a}=this.config,l=document.createElement("canvas");l.setAttribute("width",t),l.setAttribute("height",e);const h=l.getContext("2d");h.font=i,h.textAlign=n,h.textBaseline=r,h.fillStyle=o,h.translate(parseFloat(t)/2,parseFloat(e)/2),h.rotate(Math.PI/180*s),h.fillText(a,0,0),this.dataUrl=l.toDataURL()}generateStyleString(){const{zIndex:t}=this.config,{offsetWidth:e,offsetHeight:i,offsetTop:n,offsetLeft:r}=this.container;this.styleString=`\n      position: ${this.isFixed?"fixed":"absolute"};\n      top: 0;\n      left: 0;\n      width: 100%;\n      height: 100%;\n      z-index: ${t};\n      pointer-events:none;\n      background-repeat:repeat;\n      background-image: url("${this.dataUrl}");\n    `}generateWatermark(){this.wm=document.createElement("div"),this.wm.setAttribute("style",this.styleString),this.wm.setAttribute("class","_watermark"),this.container.appendChild(this.wm)}observerContainer(){const t=window.MutationObserver;t&&(this.observer=new t((()=>{const t=document.querySelector("._watermark");if(!t||t&&t.getAttribute("style")!==styleString){this.hidden();const t=new i(this.config);this.hidden=()=>{t.hidden()}}})),this.observer.observe(this.container,{childList:!0,attributes:!0,subtree:!0}))}hidden(){this.observer&&this.observer.disconnect(),this.observer=null,this.wm&&this.wm.remove&&this.wm.remove()}}return e})()));