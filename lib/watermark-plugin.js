!function(e,t){if("object"==typeof exports&&"object"==typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var i=t();for(var n in i)("object"==typeof exports?exports:e)[n]=i[n]}}(self,(()=>(()=>{"use strict";var e={d:(t,i)=>{for(var n in i)e.o(i,n)&&!e.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:i[n]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},t={};e.r(t),e.d(t,{Watermark:()=>i});class i{config={container:null,content:"watermark",width:300,height:200,zIndex:1e3,font:"28px auto",textAlign:"center",textBaseline:"middle",color:"rgba(0, 0, 0, 0.2)",rotate:-34};container=null;isFixed=!1;dataUrl=void 0;styleString="";wm=void 0;observer=void 0;constructor(e={}){this.config={...this.config,...e},this.container=this.config.container,this.setContainer(),this.generateDataUrl(),this.generateStyleString(),this.generateWatermark(),this.observerContainer()}setContainer(){this.container||(this.container=document.querySelector("body"),this.isFixed=!0),this.isFixed||["absolute","relative","fixed"].includes(this.container.style.position)||(this.container.style.position="relative")}generateDataUrl(){const{width:e,height:t,font:i,textAlign:n,textBaseline:r,color:o,rotate:s,content:a}=this.config,l=document.createElement("canvas");l.setAttribute("width",e),l.setAttribute("height",t);const c=l.getContext("2d");c.font=i,c.textAlign=n,c.textBaseline=r,c.fillStyle=o,c.translate(parseFloat(e)/2,parseFloat(t)/2),c.rotate(Math.PI/180*s),c.fillText(a,0,0),this.dataUrl=l.toDataURL()}generateStyleString(){const{zIndex:e}=this.config;this.styleString=`\n      position: ${this.isFixed?"fixed":"absolute"};\n      top: 0;\n      left: 0;\n      width: 100%;\n      height: 100%;\n      z-index: ${e};\n      pointer-events:none;\n      background-repeat:repeat;\n    `.replaceAll(/[\n]|[\ +]/g,"")+`background-image: url("${this.dataUrl}");`}generateWatermark(){this.wm=document.createElement("div"),this.wm.setAttribute("style",this.styleString),this.wm.setAttribute("class","_watermark"),this.container.appendChild(this.wm)}observerContainer(){const e=window.MutationObserver;e&&(this.observer=new e((()=>{const e=document.querySelector("._watermark");if(!e||e&&e.getAttribute("style")!==styleString){this.hidden();const e=new i(this.config);this.hidden=()=>{e.hidden()}}})),this.observer.observe(this.container,{childList:!0,attributes:!0,subtree:!0}))}hidden(){this.observer&&this.observer.disconnect(),this.observer=null,this.wm&&this.wm.remove&&this.wm.remove()}}return t})()));