!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.Watermark=e():t.Watermark=e()}(self,(()=>(()=>{"use strict";var t={d:(e,n)=>{for(var i in n)t.o(n,i)&&!t.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:n[i]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e)},e={};t.d(e,{default:()=>i});class n{config={container:null,content:"watermark",width:300,height:200,zIndex:1e3,font:"28px auto",textAlign:"center",textBaseline:"middle",color:"rgba(0, 0, 0, 0.2)",rotate:-34};container=null;isFixed=!1;dataUrl=void 0;styleString="";wm=void 0;observer=void 0;constructor(t={}){this.config={...this.config,...t},this.setContainer(this.config.container);try{if(this.container._watermarkInstance&&((t,e)=>{if(t===e)return!0;let n=Object.getOwnPropertyNames(t),i=Object.getOwnPropertyNames(e);if(n.length!==i.length)return!1;for(let n in t)if(!e.hasOwnProperty(n)||e[n]!==t[n])return!1;return!0})(this.container._watermarkInstance.config,this.config))return this.container._watermarkInstance;this.container._watermarkInstance=this}catch(t){console.log("Please enter the correct configs.",t)}this.init()}setContainer(t){t?(this.container=t,["absolute","relative","fixed"].includes(this.container.style.position)||(this.container.style.position="relative")):(this.container=document.querySelector("body"),this.isFixed=!0)}init(){this.generateDataUrl(),this.generateStyleString(),this.generateWatermark(),this.observerContainer()}generateDataUrl(){const{width:t,height:e,font:n,textAlign:i,textBaseline:r,color:s,rotate:o,content:a}=this.config,l=document.createElement("canvas");l.setAttribute("width",t),l.setAttribute("height",e);const c=l.getContext("2d");c.font=n,c.textAlign=i,c.textBaseline=r,c.fillStyle=s,c.translate(parseFloat(t)/2,parseFloat(e)/2),c.rotate(Math.PI/180*o),c.fillText(a,0,0),this.dataUrl=l.toDataURL()}generateStyleString(){const{zIndex:t}=this.config;this.styleString=`\n      position: ${this.isFixed?"fixed":"absolute"};\n      top: 0;\n      left: 0;\n      width: 100%;\n      height: 100%;\n      z-index: ${t};\n      pointer-events:none;\n      background-repeat:repeat;\n    `.replaceAll(/[\n]|[\ +]/g,"")+`background-image: url("${this.dataUrl}");`}generateWatermark(){this.wm=document.createElement("div"),this.wm.setAttribute("style",this.styleString),this.wm.setAttribute("class","_watermark"),this.container.appendChild(this.wm)}observerContainer(){const t=window.MutationObserver;t&&(this.observer=new t((()=>{const t=(t=>{if(!t)return null;for(let e of t.childNodes.values())if("_watermark"===e.className)return e;return null})(this.container);if(!t||t&&t.getAttribute("style")!==this.styleString){this.hidden();const t=new n(this.config);this.hidden=()=>{t.hidden()}}})),this.observer.observe(this.container,{childList:!0,attributes:!0,subtree:!0}))}hidden(){this.observer&&this.observer.disconnect(),this.observer=null,this.wm&&this.wm.remove&&this.wm.remove(),this.container._watermarkInstance=null}}const i=n;return e.default})()));
//# sourceMappingURL=the-watermark.min.js.map